# Name
Vulnerability Ni8mare CVE-2026-21858

# Description
Sentinel / MDE queries to identify potential n8n use in M65 Defender logs

critical vulnerability (CVE-2026-21858, CVSS 10.0) in n8n that enables attackers to take over locally deployed instances, impacting an estimated 100,000 servers globally. No official workarounds are available for this vulnerability. Users should upgrade to version 1.121.0 or later to remediate the vulnerability. n8n is the go-to platform for building automated workflows in the age of AI and AI agents. With over 100 million Docker pulls, millions of users, and thousands of enterprises using it, n8n has become the central nervous system of automation infrastructure, and thereâ€™s a good chance your organization uses it too. 

# References
- https://www.cyera.com/research-labs/ni8mare-unauthenticated-remote-code-execution-in-n8n-cve-2026-21858

# Author
- M4nbat

# Socials
- https://www.linkedin.com/in/grjk83/
- @knappresearchlb

# Threats
- Emerging

# MITRE ATT&CK
- Lateral Movement
- T1210 : Exploitation of Remote Services
- Initial Access
- T1190 : Exploit Public-Facing Application

# Data Sources
- M65 Defender
  - DeviceInfo
  - DeviceProcessEvents

# Query

## 1

```
DeviceTvmSoftwareInventory
| where OSPlatform =~ "Linux" and SoftwareName contains "n8n" and SoftwareVersion !contains "1.121."

```

## 2

```
let Linux = DeviceInfo
| where TimeGenerated > ago(14d)
| where OSPlatform =~ "Linux"
| distinct tolower(DeviceId);
DeviceProcessEvents
| where DeviceId in~ (Linux) and ProcessCommandLine contains " n8n " or ProcessCommandLine startswith "n8n"
//| count | where Count > 0

```

## 3

```
DeviceInfo| where OSPlatform =~ "Linux"| where DeviceName contains "n8n"

```
